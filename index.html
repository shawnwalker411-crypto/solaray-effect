<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sola Ray Effect | Home Mining Calculator</title>
    <meta name="description" content="Home mining calculator for ASIC miners. Estimate daily coin yield, revenue, and profitability with a conservative, home-miner-first approach.">
<link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --sola-teal: #00CED1;
      --sola-teal-dark: #008B8B;
      --sola-teal-glow: rgba(0, 206, 209, 0.4);
      --sola-teal-bright: #00E5E8;
      --sola-gold: #D4AF37;
      --sola-gold-dark: #DAA520;
      --sola-gold-glow: rgba(255, 215, 0, 0.3);
      --bg-primary: #0a0f14;
      --bg-secondary: #1a2836;
      --bg-card: #22303f;
      --bg-card-hover: #2a3a4a;
      --text-primary: #e8f0f7;
      --text-secondary: #8899a8;
      --text-muted: #5a6a7a;
      --profit: #00e676;
      --loss: #ff5252;
      --border-color: rgba(0, 206, 209, 0.4);
      --border-gold: rgba(255, 215, 0, 0.3);
      --v120: #00e676;
      --v240: #ff9800;
      --loki: #9c27b0;
      --idle: #607d8b;
      --sola-emerald: #0B2F26;
    }
    
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      background-color: var(--sola-emerald);
      background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='600' viewBox='0 0 600 600'><rect width='600' height='600' fill='none'/><g stroke='%23D4AF37' stroke-width='2' fill='none' opacity='0.18' stroke-linecap='round' stroke-linejoin='round'><path d='M40 80 H210 V140 H360'/><path d='M120 220 H260 V180 H420 V240 H560'/><path d='M60 340 H220 V400 H360 V460 H520'/><path d='M300 40 V170 H460 V120 H560'/><path d='M40 520 H180 V460 H320 V540 H560'/><path d='M520 60 V200 H420 V320 H560'/><path d='M80 140 V260 H40'/><path d='M240 300 V520 H180'/></g><g fill='%23D4AF37' opacity='0.25'><circle cx='210' cy='140' r='4'/><circle cx='260' cy='180' r='4'/><circle cx='420' cy='240' r='4'/><circle cx='360' cy='460' r='4'/><circle cx='460' cy='120' r='4'/><circle cx='320' cy='540' r='4'/><circle cx='420' cy='320' r='4'/><circle cx='240' cy='520' r='4'/></g></svg>");
      background-repeat: repeat;
      background-position: 0 0;
      background-size: 600px 600px;
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }
    
    h1, h2, h3 { font-family: 'Noto Sans JP', sans-serif; }
    
    .container { max-width: 900px; margin: 0 auto; padding: 1rem; }
    
    /* ============================================
       HAMBURGER MENU
       ============================================ */
    .hamburger-menu {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
    }
    
    .hamburger-btn {
      background: var(--bg-card);
      border: 2px solid var(--sola-teal);
      color: var(--sola-teal);
      width: 44px;
      height: 44px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 5px;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px var(--sola-teal-glow);
    }
    
    .hamburger-btn:hover {
      background: var(--sola-teal);
      color: #000;
      box-shadow: 0 0 20px var(--sola-teal-glow);
    }
    
    .hamburger-btn .bun-top {
      width: 24px;
      height: 6px;
      background: linear-gradient(180deg, #F4A460 0%, #DEB887 100%);
      border-radius: 10px 10px 0 0;
      transition: all 0.3s ease;
    }
    
    .hamburger-btn .lettuce {
      width: 26px;
      height: 3px;
      background: #32CD32;
      border-radius: 1px;
      transition: all 0.3s ease;
    }
    
    .hamburger-btn .patty {
      width: 24px;
      height: 4px;
      background: linear-gradient(180deg, #8B4513 0%, #654321 100%);
      border-radius: 2px;
      transition: all 0.3s ease;
    }
    
    .hamburger-btn .cheese {
      width: 26px;
      height: 3px;
      background: #FFD700;
      border-radius: 1px;
      transform: skewX(-5deg);
      transition: all 0.3s ease;
    }
    
    .hamburger-btn .bun-bottom {
      width: 24px;
      height: 5px;
      background: linear-gradient(180deg, #DEB887 0%, #F4A460 100%);
      border-radius: 0 0 6px 6px;
      transition: all 0.3s ease;
    }
    
    .hamburger-btn.open .bun-top { transform: rotate(45deg) translate(6px, 8px); }
    .hamburger-btn.open .lettuce { opacity: 0; }
    .hamburger-btn.open .patty { opacity: 0; }
    .hamburger-btn.open .cheese { opacity: 0; }
    .hamburger-btn.open .bun-bottom { transform: rotate(-45deg) translate(6px, -8px); }
    
    .nav-drawer {
      position: fixed;
      top: 0;
      left: -280px;
      width: 280px;
      height: 100vh;
      background: var(--bg-secondary);
      border-right: 2px solid var(--sola-teal);
      z-index: 999;
      transition: left 0.3s ease;
      padding: 80px 1.5rem 2rem;
      box-shadow: 5px 0 30px rgba(0, 0, 0, 0.5);
    }
    
    .nav-drawer.open { left: 0; }
    
    .nav-drawer h3 {
      color: var(--sola-gold);
      font-size: 1rem;
      margin-bottom: 1.5rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-gold);
    }
    
    .nav-drawer a, .nav-drawer .nav-disabled {
      display: block;
      color: var(--text-primary);
      text-decoration: none;
      padding: 0.75rem 1rem;
      margin-bottom: 0.5rem;
      border-radius: 6px;
      font-size: 1.1rem;
      transition: all 0.2s ease;
      border: 1px solid transparent;
    }
    
    .nav-drawer a:hover {
      background: var(--bg-card);
      border-color: var(--sola-teal);
      color: var(--sola-teal);
    }
    
    .nav-drawer a.active {
      background: rgba(0, 206, 209, 0.15);
      border-color: var(--sola-teal);
      color: var(--sola-teal);
    }
    
    .nav-drawer .nav-disabled {
      color: var(--text-muted);
      cursor: not-allowed;
    }
    
    .nav-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 998;
    }
    
    .nav-overlay.show { display: block; }
    
    /* ============================================
       HEADER
       ============================================ */
    header {
      text-align: center;
      padding: 1.5rem 1rem 2rem;
      border-bottom: 2px solid var(--border-color);
      margin-bottom: 2rem;
      position: relative;
      background: linear-gradient(180deg, rgba(0, 206, 209, 0.05) 0%, transparent 100%);
    }
    
    .header-image {
      max-width: 100%;
      height: auto;
      max-height: 180px;
      border-radius: 12px;
      margin-bottom: 0.75rem;
      box-shadow: 0 4px 20px rgba(0, 206, 209, 0.3);
    }
    
    header p {
      color: var(--text-secondary);
      font-size: 1.1rem;
      margin-top: 0.5rem;
    }
    
    .reset-btn {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-family: 'Roboto', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .reset-btn:hover {
      border-color: var(--sola-gold);
      color: var(--sola-gold);
      box-shadow: 0 0 10px var(--sola-gold-glow);
    }
    
    /* ============================================
       SECTIONS - 30% LIGHTER
       ============================================ */
    .section {
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3), inset 0 1px 0 rgba(0, 206, 209, 0.1);
    }
    
    .section-title {
      font-size: 1.2rem;
      color: var(--sola-teal);
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-gold);
    }
    

    /* Solid panel for readability over circuit pattern */
    .solid-panel {
      background: rgba(8, 26, 21, 0.78);
      border: 1px solid rgba(212, 175, 55, 0.18);
      border-radius: 18px;
      backdrop-filter: blur(6px);
    }
    /* ============================================
       LIVE PRICE DISPLAY
       ============================================ */
    .live-price-display {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, rgba(0, 206, 209, 0.1), rgba(255, 215, 0, 0.05));
      border: 1px solid var(--border-color);
      border-radius: 8px;
    }
    
    .live-price-coin {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      color: var(--sola-gold);
    }
    
    .live-price-value {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--sola-teal);
    }
    
    .live-price-status {
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      background: rgba(0, 230, 118, 0.15);
      color: #00e676;
    }
    
    .live-price-status.cached {
      background: rgba(255, 193, 7, 0.15);
      color: #ffc107;
    }
    
    .live-price-status.custom {
      background: rgba(138, 43, 226, 0.2);
      color: #bb86fc;
    }
    
    .price-input-wrapper {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .price-currency {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--sola-teal);
    }
    
    .live-price-input {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--sola-teal);
      background: transparent;
      border: none;
      border-bottom: 2px dashed transparent;
      padding: 0;
      width: auto;
      min-width: 60px;
      max-width: 140px;
      text-align: left;
      cursor: pointer;
      transition: border-color 0.2s, background 0.2s;
    }
    
    .live-price-input:hover {
      border-bottom-color: var(--sola-teal);
    }
    
    .live-price-input:focus {
      outline: none;
      border-bottom-color: var(--sola-gold);
      background: rgba(255, 215, 0, 0.1);
      cursor: text;
    }
    
    .live-price-input.custom-price {
      color: #bb86fc;
      border-bottom: 2px solid #bb86fc;
    }
    
    .price-reset-btn {
      background: rgba(138, 43, 226, 0.2);
      border: none;
      color: #bb86fc;
      font-size: 1rem;
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .price-reset-btn:hover {
      background: rgba(138, 43, 226, 0.4);
    }
    
    .live-price-status.default {
      background: rgba(255, 82, 82, 0.15);
      color: #ff5252;
    }
    
    /* ============================================
       DROPDOWNS & INPUTS
       ============================================ */
    .dropdown-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin-bottom: 1rem;
      align-items: start;
    }
    
    @media (max-width: 600px) {
      .dropdown-row {
        grid-template-columns: 1fr;
      }
    }
    
    .dropdown-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }
    
    .dropdown-group.miner-dropdown-full {
      width: 100%;
    }
    
    #miner-row {
      display: grid;
      grid-template-columns: 1fr;
    }
    
    .dropdown-group label {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    
    select, input {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      padding: 0.6rem 0.75rem;
      border-radius: 6px;
      font-family: 'Roboto', sans-serif;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    select:focus, input:focus {
      outline: none;
      border-color: var(--sola-teal);
      box-shadow: 0 0 10px var(--sola-teal-glow);
    }
    
    select option {
      background: var(--bg-card);
      color: var(--text-primary);
    }
    
    /* ============================================
       MINER INFO CARD
       ============================================ */
    .miner-info {
      display: none;
      background: var(--bg-card);
      border: 2px solid var(--sola-teal);
      border-radius: 10px;
      padding: 1.25rem;
      margin-top: 1rem;
      box-shadow: 0 0 15px var(--sola-teal-glow);
    }
    
    .miner-info.active { display: block; }
    
    .miner-info.loki-miner {
      border-color: var(--loki);
      box-shadow: 0 0 15px rgba(156, 39, 176, 0.4);
    }
    
    .miner-info-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid var(--border-gold);
    }
    
    .miner-info-name {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1.2rem;
      color: var(--sola-gold);
    }
    
    .miner-info-name.loki {
      color: var(--loki);
    }
    
    .miner-info-manufacturer {
      font-size: 0.9rem;
      color: var(--text-muted);
    }
    
    .badge {
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .badge-lottery {
      background: rgba(255, 215, 0, 0.2);
      color: var(--sola-gold);
      border: 1px solid var(--sola-gold);
    }
    
    .badge-loki {
      background: rgba(156, 39, 176, 0.2);
      color: var(--loki);
      border: 1px solid var(--loki);
    }
    
    .miner-info-specs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem 2rem;
    }
    
    .spec-item {
      display: flex;
      justify-content: space-between;
      padding: 0.3rem 0;
    }
    
    .spec-label {
      color: var(--text-secondary);
    }
    
    .spec-value {
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .spec-value.v120 { color: var(--v120); }
    .spec-value.v240 { color: var(--v240); }
    
    .run-cost {
      grid-column: 1 / -1;
      margin-top: 0.5rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--border-color);
      font-size: 1.1rem;
      color: var(--sola-gold);
    }
    
    .run-cost-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }
    
    .loki-notice {
      grid-column: 1 / -1;
      margin-top: 0.75rem;
      padding: 0.75rem;
      background: rgba(156, 39, 176, 0.1);
      border: 1px solid var(--loki);
      border-radius: 6px;
      font-size: 0.9rem;
      color: var(--text-primary);
    }
    
    .loki-notice a {
      color: var(--loki);
      text-decoration: underline;
    }
    
    .loki-notice a:hover {
      color: #ce93d8;
    }
    
    /* Configuration */
    .config-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .config-group label {
      display: block;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 0.25rem;
    }
    
    .config-group input {
      width: 100%;
    }
    
    /* ============================================
       ELECTRICITY
       ============================================ */
    .electricity-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 1rem;
    }
    
    .dev-fee-row {
      display: flex;
      align-items: center;
      gap: 2rem;
      margin-top: 1rem;
      padding: 0.75rem 1rem;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
      flex-wrap: wrap;
    }
    
    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      font-size: 1rem;
    }
    
    .checkbox-label input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--sola-gold);
      cursor: pointer;
    }
    
    .firmware-link {
      color: var(--sola-gold);
      text-decoration: none;
    }
    
    .firmware-link:hover {
      text-decoration: underline;
    }
    
    .dev-fee-input {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .dev-fee-input input {
      width: 70px;
      padding: 0.4rem;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 6px;
      color: var(--text-primary);
      font-size: 1rem;
    }
    
    .timeline {
      display: flex;
      height: 36px;
      border-radius: 6px;
      overflow: hidden;
      margin-top: 1rem;
      border: 1px solid var(--border-color);
    }
    
    .timeline-segment {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: #000;
    }
    
    .timeline-solar { background: var(--sola-gold); }
    .timeline-free { background: #00e676; }
    .timeline-battery { background: #2196f3; }
    .timeline-grid { background: #ff5252; }
    .timeline-idle { background: var(--idle); color: #fff; }
    
    .timeline-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 0.5rem;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 3px;
    }
    
    /* ============================================
       MANUAL INPUT SECTION (GPU/CPU)
       ============================================ */
    .manual-input-section {
      background: var(--bg-card);
      border: 2px solid var(--sola-teal);
      border-radius: 10px;
      padding: 1.25rem;
      margin-top: 1rem;
    }
    
    .manual-input-header {
      margin-bottom: 1rem;
    }
    
    .manual-input-header h3 {
      font-family: 'Noto Sans JP', sans-serif;
      color: var(--sola-teal);
      font-size: 1.1rem;
      margin-bottom: 0.25rem;
    }
    
    .manual-input-note {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    
    .manual-input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
    }
    
    .hashrate-input-row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .hashrate-input-row input {
      flex: 1;
    }
    
    .unit-label {
      color: var(--sola-gold);
      font-weight: 600;
      font-size: 0.9rem;
      white-space: nowrap;
    }
    
    /* ============================================
       CALCULATE BUTTON
       ============================================ */
    .calculate-btn {
      display: block;
      width: 100%;
      padding: 1rem;
      margin-top: 1rem;
      background: linear-gradient(135deg, var(--sola-teal), var(--sola-teal-dark));
      border: 2px solid var(--sola-gold);
      border-radius: 8px;
      color: #000;
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .calculate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 20px var(--sola-teal-glow), 0 0 30px var(--sola-gold-glow);
    }
    
    /* ============================================
       RESULTS
       ============================================ */
    .results-panel { display: none; }
    .results-panel.active { display: block; }
    
    .roi-box {
      background: linear-gradient(135deg, rgba(0, 206, 209, 0.1), rgba(255, 215, 0, 0.1));
      border: 2px solid var(--sola-teal);
      border-radius: 10px;
      padding: 1.25rem;
      margin-bottom: 1rem;
      text-align: center;
      box-shadow: 0 0 20px var(--sola-teal-glow);
    }
    
    .roi-title {
      font-family: 'Noto Sans JP', sans-serif;
      font-size: 1rem;
      color: var(--sola-gold);
      margin-bottom: 1rem;
    }
    
    .roi-stats {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }
    
    .roi-stat { text-align: center; }
    
    .roi-stat-value {
      font-size: 1.75rem;
      font-weight: 700;
      font-family: 'Noto Sans JP', sans-serif;
    }
    
    .roi-stat-value.profit { color: var(--profit); }
    .roi-stat-value.loss { color: var(--loss); }
    
    .roi-stat-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }
    
    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
    }
    
    .result-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 1rem;
    }
    
    .result-card h4 {
      color: var(--sola-teal);
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      padding-bottom: 0.25rem;
      border-bottom: 1px solid var(--border-gold);
    }
    
    .result-row {
      display: flex;
      justify-content: space-between;
      padding: 0.2rem 0;
      font-size: 0.9rem;
    }
    
    .result-label { color: var(--text-secondary); }
    .result-value { font-weight: 600; }
    
    /* ============================================
       BROWSE ALL
       ============================================ */
    .browse-section { margin-top: 1.5rem; }
    
    .browse-toggle {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: none;
      border: 2px solid var(--border-color);
      color: var(--text-secondary);
      padding: 0.75rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-family: 'Roboto', sans-serif;
      font-size: 1rem;
      width: 100%;
      transition: all 0.2s ease;
    }
    
    .browse-toggle:hover {
      border-color: var(--sola-teal);
      color: var(--sola-teal);
    }
    
    .browse-toggle .arrow { transition: transform 0.2s ease; }
    .browse-toggle.open .arrow { transform: rotate(90deg); }
    
    .browse-table-container {
      display: none;
      margin-top: 1rem;
      overflow-x: auto;
    }
    
    .browse-table-container.open { display: block; }
    
    .browse-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    
    .browse-table th {
      text-align: left;
      padding: 0.6rem 0.75rem;
      background: var(--bg-card);
      color: var(--sola-teal);
      border-bottom: 2px solid var(--border-color);
      cursor: pointer;
      white-space: nowrap;
    }
    
    .browse-table th:hover { color: var(--sola-gold); }
    
    .browse-table td {
      padding: 0.5rem 0.75rem;
      border-bottom: 1px solid var(--border-color);
    }
    
    .browse-table tr:hover td { 
      background: var(--bg-card); 
      color: var(--sola-teal);
    }
    
    .browse-table .v120 { color: var(--v120); }
    .browse-table .v240 { color: var(--v240); }
    .browse-table .loki { color: var(--loki); }
    
    /* ============================================
       GLOSSARY DRAWER
       ============================================ */
    .glossary-drawer {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      max-width: 90vw;
      height: 100vh;
      background: var(--bg-secondary);
      border-left: 2px solid var(--sola-teal);
      z-index: 1001;
      transition: right 0.3s ease;
      padding: 2rem 1.5rem;
      overflow-y: auto;
      box-shadow: -5px 0 30px rgba(0, 206, 209, 0.3);
    }
    
    .glossary-drawer.open { right: 0; }
    
    .glossary-drawer-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: 1px solid var(--sola-teal);
      color: var(--sola-teal);
      width: 32px;
      height: 32px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1.2rem;
      transition: all 0.2s ease;
    }
    
    .glossary-drawer-close:hover {
      background: var(--sola-teal);
      color: #000;
    }
    
    .glossary-drawer h3 {
      font-family: 'Noto Sans JP', sans-serif;
      color: var(--sola-gold);
      font-size: 1.3rem;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border-gold);
    }
    
    .glossary-drawer p {
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: 1.5rem;
    }
    
    .glossary-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }
    
    .glossary-overlay.show { display: block; }
    
    /* Glossary terms in content */
    .glossary-term {
      color: var(--sola-teal);
      border-bottom: 1px dotted var(--sola-teal);
      cursor: help;
      transition: all 0.2s ease;
    }
    
    .glossary-term:hover {
      color: var(--sola-gold);
      border-color: var(--sola-gold);
    }
    
    /* ============================================
       FOOTER
       ============================================ */
    footer {
      text-align: center;
      padding: 1.5rem 1rem;
      color: var(--text-muted);
      font-size: 0.85rem;
      border-top: 2px solid var(--border-color);
      margin-top: 2rem;
    }
    
    footer a {
      color: var(--sola-teal);
      text-decoration: none;
    }
    
    footer a:hover {
      color: var(--sola-gold);
    }
    
    .price-note {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
    }
    
    .price-status {
      display: flex;
      justify-content: center;
      gap: 1rem;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 0.75rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--border-color);
    }
    
    .price-indicator {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }
    
    .price-indicator.live {
      background: rgba(0, 230, 118, 0.15);
      color: #00e676;
    }
    
    .price-indicator.cached {
      background: rgba(255, 193, 7, 0.15);
      color: #ffc107;
    }
    
    .price-indicator.default {
      background: rgba(255, 82, 82, 0.15);
      color: #ff5252;
    }
    
    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 600px) {
      .header-image { max-height: 120px; }
      .glossary-drawer { width: 100%; right: -100%; }
      .miner-info-specs { grid-template-columns: 1fr; }
      .roi-stats { gap: 1rem; }
      .roi-stat-value { font-size: 1.4rem; }
      .electricity-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <!-- Hamburger Menu -->
  <div class="hamburger-menu">
    <button class="hamburger-btn" id="hamburger-btn" onclick="toggleNav()" aria-label="Open navigation menu">
      <span class="bun-top"></span>
      <span class="lettuce"></span>
      <span class="patty"></span>
      <span class="cheese"></span>
      <span class="bun-bottom"></span>
    </button>
  </div>
  
  <!-- Navigation Drawer -->
  <nav class="nav-drawer" id="nav-drawer">
    <h3>Navigation</h3>
    <a href="index.html" class="active">‚ö° Calculator</a>
    <a href="aftermarket_firmware.html">üîß Firmware Guide</a>
    <a href="electrical_setup.html">üîå Electrical Setup</a>
    <a href="glossary.html">üìñ Glossary</a>
    <a href="pools.html">üèä Mining Pools</a>
  </nav>
  <div class="nav-overlay" id="nav-overlay" onclick="toggleNav()"></div>
  
  <!-- Glossary Drawer -->
  <div class="glossary-drawer" id="glossary-drawer">
    <button class="glossary-drawer-close" onclick="closeGlossary()">√ó</button>
    <h3 id="glossary-term-title">Term</h3>
    <p id="glossary-term-definition">Definition goes here...</p>
  </div>
  <div class="glossary-overlay" id="glossary-overlay" onclick="closeGlossary()"></div>

  <div class="container">
    <header>
      <button class="reset-btn" onclick="resetCalculator()">‚Ü∫ Reset</button>
      <img src="assets/img-e688b707c7.jpg" alt="The Sola Ray Effect" class="header-image">
      <p>Home Mining Profitability Calculator</p>
    </header>
    
    <!-- Miner Selection -->
    <section class="section">
      <h2 class="section-title">üîß Select Your Miner</h2>
      
      <!-- Live Coin Price Display -->
      <div class="live-price-display" id="live-price-display" style="display: none;">
        <span class="live-price-coin" id="live-price-coin">BTC</span>
        <div class="price-input-wrapper">
          <span class="price-currency">$</span>
          <input type="text" class="live-price-input" id="live-price-input" value="89000" title="Click to edit price for what-if scenarios">
          <button class="price-reset-btn" id="price-reset-btn" title="Reset to live price" style="display: none;">‚Ü∫</button>
        </div>
        <span class="live-price-status" id="live-price-status">üü¢ Live</span>
      </div>
      
      <div class="dropdown-row">
        <div class="dropdown-group">
          <label><span class="glossary-term" data-term="mining-type">Mining Type</span></label>
          <select id="mining-type-filter" onchange="updateMiningType()">
            <option value="ASIC">ASIC</option>
            <option value="GPU">GPU</option>
            <option value="CPU">CPU</option>
          </select>
        </div>
        <div class="dropdown-group" id="voltage-group">
          <label><span class="glossary-term" data-term="voltage">Voltage</span></label>
          <select id="voltage-filter">
            <option value="all">All</option>
            <option value="120V">120V (Standard Outlet)</option>
            <option value="240V">240V (Requires Install)</option>
          </select>
        </div>
        <div class="dropdown-group">
          <label><span class="glossary-term" data-term="algorithm">Algorithm</span></label>
          <select id="algorithm-filter">
            <option value="all">All Algorithms</option>
            <option value="SHA-256">SHA-256 (BTC)</option>
            <option value="SHA-256-BCH">SHA-256 (BCH)</option>
            <option value="Scrypt">Scrypt (LTC+DOGE)</option>
            <option value="KHeavyHash">KHeavyHash (KAS)</option>
            <option value="Etchash">Etchash (ETC)</option>
            <option value="Equihash">Equihash (ZEC)</option>
            <option value="X11">X11 (DASH)</option>
          </select>
        </div>
      </div>
      <div class="dropdown-row" id="miner-row">
        <div class="dropdown-group miner-dropdown-full">
          <label>Miner</label>
          <select id="miner-select">
            <option value="">-- Select Miner --</option>
          </select>
        </div>
      </div>
      
      <!-- GPU/CPU Manual Input Section (hidden by default) -->
      <div class="manual-input-section" id="manual-input-section" style="display: none;">
        <div class="manual-input-header">
          <h3 id="manual-input-title">‚õèÔ∏è GPU Mining Setup</h3>
          <p class="manual-input-note">Enter your hardware specs from your mining software</p>
        </div>
        <div class="manual-input-grid">
          <div class="config-group">
            <label>Hashrate</label>
            <div class="hashrate-input-row">
              <input type="number" id="manual-hashrate" placeholder="0" min="0" step="0.01">
              <span class="unit-label" id="manual-unit-label">MH/s</span>
            </div>
          </div>
          <div class="config-group">
            <label>Power (W)</label>
            <input type="number" id="manual-power" placeholder="0" min="0">
          </div>
          <div class="config-group">
            <label>Purchase Price ($)</label>
            <input type="number" id="manual-cost" placeholder="0" value="0" min="0">
          </div>
        </div>
      </div>
      
      <!-- Miner Info Card -->
      <div class="miner-info" id="miner-info">
        <div class="miner-info-header">
          <div>
            <div class="miner-info-name" id="info-name">Miner Name</div>
            <div class="miner-info-manufacturer" id="info-manufacturer">Manufacturer</div>
          </div>
          <div>
            <span class="badge badge-lottery" id="info-lottery" style="display: none;"><span class="glossary-term" data-term="lottery">LOTTERY</span></span>
            <span class="badge badge-loki" id="info-loki-badge" style="display: none;"><span class="glossary-term" data-term="loki-kit">LOKI</span></span>
          </div>
        </div>
        <div class="miner-info-specs">
          <div class="spec-item">
            <span class="spec-label"><span class="glossary-term" data-term="hashrate">Hashrate</span></span>
            <span class="spec-value" id="info-hashrate">0 TH/s</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Power</span>
            <span class="spec-value" id="info-power">0W</span>
          </div>
          <div class="spec-item">
            <span class="spec-label"><span class="glossary-term" data-term="voltage">Voltage</span></span>
            <span class="spec-value" id="info-voltage">120V</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Noise</span>
            <span class="spec-value" id="info-noise">üîá Silent</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Cooling</span>
            <span class="spec-value" id="info-cooling">Room Temp</span>
          </div>
          <div class="spec-item">
            <span class="spec-label">Coins</span>
            <span class="spec-value" id="info-coins">BTC</span>
          </div>
          <div class="run-cost">
            <span id="info-runcost">‚ö° $0.00/day to run</span>
            <div class="run-cost-note">*at $0.15/kWh</div>
          </div>
          <div class="loki-notice" id="loki-notice" style="display: none;">
            ‚ö° Requires <strong><span class="glossary-term" data-term="loki-kit">Loki Kit</span></strong> + <a href="aftermarket_firmware.html" target="_blank"><span class="glossary-term" data-term="aftermarket-firmware">aftermarket firmware</span></a> (LuxOS, VNish, or BraiinsOS)
          </div>
        </div>
        
        <div class="config-row">
          <div class="config-group">
            <label>Adjust <span class="glossary-term" data-term="hashrate">Hashrate</span></label>
            <input type="number" id="config-hashrate" placeholder="0">
          </div>
          <div class="config-group">
            <label>Adjust Power (W)</label>
            <input type="number" id="config-power" placeholder="0">
          </div>
          <div class="config-group">
            <label>Purchase Price ($)</label>
            <input type="number" id="miner-cost" placeholder="0" value="0">
          </div>
        </div>
      </div>
    </section>
    
    <!-- Electricity -->
    <section class="section">
      <h2 class="section-title">‚ö° Electricity Setup</h2>
      
      <div class="electricity-grid">
        <div class="config-group">
          <label>‚òÄÔ∏è Solar Hours/Day</label>
          <input type="number" id="solar-hours" value="6" min="0" max="24" oninput="capHours(this)">
        </div>
        <div class="config-group">
          <label>üåô Free Night Hours</label>
          <input type="number" id="free-hours" value="6" min="0" max="24" oninput="capHours(this)">
        </div>
        <div class="config-group">
          <label>üîã Battery Hours</label>
          <input type="number" id="battery-hours" value="0" min="0" max="24" oninput="capHours(this)">
        </div>
        <div class="config-group">
          <label>‚è∏Ô∏è Idle/Off Hours</label>
          <input type="number" id="idle-hours" value="0" min="0" max="24" oninput="capHours(this)">
        </div>
        <div class="config-group">
          <label>üíµ Grid Rate ($/kWh)</label>
          <input type="number" id="grid-rate" value="0.15" min="0" step="0.01">
        </div>
        <div class="config-group">
          <label>üèä <span class="glossary-term" data-term="pool">Pool</span> Fee (%)</label>
          <input type="number" id="pool-fee" value="1" min="0" max="10" step="1">
        </div>
        <div class="config-group" style="display: flex; flex-direction: column; gap: 0.5rem;">
          <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
            <input type="checkbox" id="use-aftermarket" onchange="toggleDevFee()" style="width: 18px; height: 18px; accent-color: var(--sola-gold);">
            <a href="aftermarket_firmware.html" style="color: var(--sola-gold); text-decoration: none;">Aftermarket Firmware</a>
          </label>
          <div id="dev-fee-wrapper" style="display: none;">
            <label style="font-size: 0.85rem; color: var(--text-secondary);">Dev Fee (%)</label>
            <input type="number" id="dev-fee" value="2" min="0" max="5" step="0.5" style="width: 80px;">
          </div>
        </div>
      </div>
      
      <div class="timeline" id="timeline"></div>
      
      <div class="timeline-legend">
        <div class="legend-item"><div class="legend-dot" style="background: var(--sola-gold);"></div> Solar</div>
        <div class="legend-item"><div class="legend-dot" style="background: #00e676;"></div> Free Nights</div>
        <div class="legend-item"><div class="legend-dot" style="background: #2196f3;"></div> Battery</div>
        <div class="legend-item"><div class="legend-dot" style="background: #ff5252;"></div> Grid ($<span id="grid-rate-display">0.15</span>)</div>
        <div class="legend-item"><div class="legend-dot" style="background: var(--idle);"></div> Idle/Off</div>
      </div>
    </section>
    
    <button class="calculate-btn" onclick="calculate()">‚ö° CALCULATE PROFITABILITY ‚ö°</button>
    
    <!-- Results -->
    <section class="section results-panel" id="results-panel">
      <h2 class="section-title">üìä Results</h2>
      
      <div class="roi-box">
        <h3 class="roi-title">üí∞ <span class="glossary-term" data-term="roi">Return on Investment</span></h3>
        <div class="roi-stats">
          <div class="roi-stat">
            <div class="roi-stat-value" id="breakeven-days" style="color: var(--sola-teal);">0</div>
            <div class="roi-stat-label">Days to Break Even</div>
          </div>
          <div class="roi-stat">
            <div class="roi-stat-value" id="annual-elec-cost" style="color: #ff5252;">$0</div>
            <div class="roi-stat-label">Annual Electricity Cost</div>
          </div>
          <div class="roi-stat">
            <div class="roi-stat-value" id="annual-elec-savings" style="color: var(--sola-gold);">$0</div>
            <div class="roi-stat-label">Annual Electricity Savings</div>
          </div>
        </div>
      </div>
      
      <div class="results-grid">
        <div class="result-card">
          <h4>Daily</h4>
          <div class="result-row"><span class="result-label">Revenue</span><span class="result-value" id="daily-revenue">$0.00</span></div>
          <div class="result-row"><span class="result-label">Electricity</span><span class="result-value" id="daily-elec">$0.00</span></div>
          <div class="result-row"><span class="result-label">Profit</span><span class="result-value" id="daily-profit">$0.00</span></div>
          <div class="result-row"><span class="result-label">Crypto</span><span class="result-value" id="daily-crypto">0.00000000</span></div>
        </div>
        <div class="result-card">
          <h4>Monthly</h4>
          <div class="result-row"><span class="result-label">Revenue</span><span class="result-value" id="monthly-revenue">$0.00</span></div>
          <div class="result-row"><span class="result-label">Electricity</span><span class="result-value" id="monthly-elec">$0.00</span></div>
          <div class="result-row"><span class="result-label">Profit</span><span class="result-value" id="monthly-profit-detail">$0.00</span></div>
          <div class="result-row"><span class="result-label">Crypto</span><span class="result-value" id="monthly-crypto">0.00000000</span></div>
        </div>
        <div class="result-card">
          <h4>Yearly</h4>
          <div class="result-row"><span class="result-label">Revenue</span><span class="result-value" id="yearly-revenue">$0.00</span></div>
          <div class="result-row"><span class="result-label">Electricity</span><span class="result-value" id="yearly-elec">$0.00</span></div>
          <div class="result-row"><span class="result-label">Profit</span><span class="result-value" id="yearly-profit">$0.00</span></div>
          <div class="result-row"><span class="result-label">Crypto</span><span class="result-value" id="yearly-crypto">0.00000000</span></div>
        </div>
      </div>
      
      <div class="price-status">
        <p class="price-note" id="price-note">Prices: BTC $89,000 | Mining 24h/day</p>
        <span class="price-indicator default" id="price-indicator">üî¥ Default Prices</span>
      </div>
    </section>
    
    <!-- Browse All Miners -->
    <section class="section browse-section">
      <button class="browse-toggle" id="browse-toggle" onclick="toggleBrowse()">
        <span class="arrow">‚ñ∂</span> Browse All Miners
      </button>
      
      <div class="browse-table-container" id="browse-table-container">
        <table class="browse-table" id="browse-table">
          <thead>
            <tr>
              <th onclick="sortTable(0)">Name ‚Üï</th>
              <th onclick="sortTable(1)"><span class="glossary-term" data-term="algorithm">Algorithm</span> ‚Üï</th>
              <th onclick="sortTable(2)"><span class="glossary-term" data-term="hashrate">Hashrate</span> ‚Üï</th>
              <th onclick="sortTable(3)">Power ‚Üï</th>
              <th onclick="sortTable(4)"><span class="glossary-term" data-term="voltage">Voltage</span> ‚Üï</th>
              <th onclick="sortTable(5)">‚ö°/day ‚Üï</th>
            </tr>
          </thead>
          <tbody id="browse-tbody"></tbody>
        </table>
      </div>
    </section>
    
    <footer>
      <p>¬© 2026 The Sola Ray Effect. Built for home miners.</p>
      <p>Estimates only. Results vary with <span class="glossary-term" data-term="difficulty">difficulty</span>, <span class="glossary-term" data-term="pool">pool</span> fees, and market conditions.</p>
    </footer>
  </div>

  <script>
    // ============================================
    // GLOSSARY DEFINITIONS (10 terms)
    // ============================================
    const GLOSSARY = {
      'hashrate': {
        title: 'Hashrate',
        definition: 'The computational power of a mining device, measured in hashes per second. Higher hashrate means more attempts to find a valid block, increasing your chances of earning rewards. Common units: TH/s (terahashes), GH/s (gigahashes), MH/s (megahashes).'
      },
      'algorithm': {
        title: 'Algorithm',
        definition: 'The cryptographic puzzle that miners must solve to validate transactions and earn rewards. Different cryptocurrencies use different algorithms: SHA-256 (Bitcoin), Scrypt (Litecoin), KHeavyHash (Kaspa), Etchash (Ethereum Classic), Blake3 (Alephium).'
      },
      'difficulty': {
        title: 'Difficulty',
        definition: 'A measure of how hard it is to find a valid block. Difficulty adjusts automatically based on total network hashrate to maintain consistent block times. Higher difficulty = less crypto earned per unit of hashrate.'
      },
      'loki-kit': {
        title: 'Loki Kit',
        definition: 'A hardware modification that allows industrial ASIC miners (designed for 240V) to run on standard 120V household outlets. The kit runs only one hash board at reduced power (~1200W), providing roughly 40% of full hashrate. Requires aftermarket firmware like LuxOS or VNish.'
      },
      'asic': {
        title: 'ASIC',
        definition: 'Application-Specific Integrated Circuit. A specialized mining device designed to mine one specific algorithm efficiently. ASICs are much more powerful than GPUs for their target algorithm but cannot mine other algorithms.'
      },
      'voltage': {
        title: 'Voltage (120V vs 240V)',
        definition: '120V is standard US household outlet power. 240V requires special installation (like a dryer outlet) but allows running high-power industrial miners at full capacity. The Loki Kit enables running 240V miners on 120V at reduced power.'
      },
      'lottery': {
        title: 'Lottery Miner',
        definition: 'Low-power USB or small ASIC miners (like Bitaxe, NerdMiner) that have very low hashrate but give you a chance to solo mine a full block reward. Called "lottery" because winning is rare but the payout is huge if you do.'
      },
      'aftermarket-firmware': {
        title: 'Aftermarket Firmware',
        definition: 'Third-party firmware (LuxOS, VNish, BraiinsOS) that replaces the manufacturer\'s software on ASIC miners. Benefits include underclocking/overclocking, better efficiency tuning, and Loki Kit compatibility.'
      },
      'pool': {
        title: 'Mining Pool',
        definition: 'A group of miners who combine their hashrate and share rewards proportionally. Pools provide steady, predictable income instead of waiting months/years to find a block solo. Most home miners use pools.'
      },
      'roi': {
        title: 'ROI (Return on Investment)',
        definition: 'A measure of how profitable your mining investment is. Calculated as (annual profit / purchase cost) √ó 100%. Higher ROI = better investment. "Days to break even" shows when you\'ve recovered your initial cost.'
      }
    };
    
    // ============================================
    // NAVIGATION FUNCTIONS
    // ============================================
    function toggleNav() {
      const btn = document.getElementById('hamburger-btn');
      const drawer = document.getElementById('nav-drawer');
      const overlay = document.getElementById('nav-overlay');
      
      btn.classList.toggle('open');
      drawer.classList.toggle('open');
      overlay.classList.toggle('show');
    }
    
    // ============================================
    // GLOSSARY FUNCTIONS
    // ============================================
    function openGlossary(term) {
      const data = GLOSSARY[term];
      if (!data) return;
      
      document.getElementById('glossary-term-title').textContent = data.title;
      document.getElementById('glossary-term-definition').textContent = data.definition;
      document.getElementById('glossary-drawer').classList.add('open');
      document.getElementById('glossary-overlay').classList.add('show');
    }
    
    function closeGlossary() {
      document.getElementById('glossary-drawer').classList.remove('open');
      document.getElementById('glossary-overlay').classList.remove('show');
    }
    
    // Initialize glossary term clicks
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.glossary-term').forEach(el => {
        el.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          const term = el.dataset.term;
          if (term) openGlossary(term);
        });
      });
    });
    
    // ============================================
    // MINER DATABASE - 120V (Native + Loki)
    // ============================================
    const MINERS_120V = [
      // LOTTERY - SHA-256
      { id: 'bitaxe-ultra', name: 'Bitaxe Ultra', manufacturer: 'Open Source', hashrate: 0.5, unit: 'TH/s', power: 15, algorithm: 'SHA-256', coins: ['BTC'], category: 'lottery', voltage: '120V', noise: 'silent', noiseLabel: 'Silent (0-30 dB)', cooling: 'Room Temp', loki: false },
      { id: 'bitaxe-hex', name: 'Bitaxe Hex', manufacturer: 'Open Source', hashrate: 3, unit: 'TH/s', power: 90, algorithm: 'SHA-256', coins: ['BTC'], category: 'lottery', voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'nerdminer', name: 'NerdMiner', manufacturer: 'Open Source', hashrate: 0.00005, unit: 'TH/s', power: 1, algorithm: 'SHA-256', coins: ['BTC'], category: 'lottery', voltage: '120V', noise: 'silent', noiseLabel: 'Silent (0-30 dB)', cooling: 'Room Temp', loki: false },
      { id: 'compac-f', name: 'Compac F', manufacturer: 'Skot', hashrate: 0.3, unit: 'TH/s', power: 7, algorithm: 'SHA-256', coins: ['BTC'], category: 'lottery', voltage: '120V', noise: 'silent', noiseLabel: 'Silent (0-30 dB)', cooling: 'Room Temp', loki: false },
      
      // LOKI - SHA-256 (40% of original hashrate, 1200W)
      { id: 's19-82t-loki', name: 'S19 82T (Loki)', manufacturer: 'Bitmain', hashrate: 33, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19-90t-loki', name: 'S19 90T (Loki)', manufacturer: 'Bitmain', hashrate: 36, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19-pro-100t-loki', name: 'S19 Pro 100T (Loki)', manufacturer: 'Bitmain', hashrate: 40, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19-pro-110t-loki', name: 'S19 Pro 110T (Loki)', manufacturer: 'Bitmain', hashrate: 44, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19j-pro-96t-loki', name: 'S19J Pro 96T (Loki)', manufacturer: 'Bitmain', hashrate: 38, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19j-pro-104t-loki', name: 'S19J Pro 104T (Loki)', manufacturer: 'Bitmain', hashrate: 42, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19k-pro-120t-loki', name: 'S19K Pro 120T (Loki)', manufacturer: 'Bitmain', hashrate: 48, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's19k-pro-136t-loki', name: 'S19K Pro 136T (Loki)', manufacturer: 'Bitmain', hashrate: 56, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      { id: 's21-200t-loki', name: 'S21 200T (Loki)', manufacturer: 'Bitmain', hashrate: 80, unit: 'TH/s', power: 1200, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      
      // NATIVE 120V - Scrypt
      { id: 'mini-doge', name: 'Mini-DOGE', manufacturer: 'GoldShell', hashrate: 185, unit: 'MH/s', power: 233, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'mini-doge-pro', name: 'Mini-DOGE Pro', manufacturer: 'GoldShell', hashrate: 205, unit: 'MH/s', power: 220, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'mini-doge-iii', name: 'Mini-DOGE III', manufacturer: 'GoldShell', hashrate: 760, unit: 'MH/s', power: 500, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'l3', name: 'Antminer L3', manufacturer: 'Bitmain', hashrate: 250, unit: 'MH/s', power: 400, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'l3-plus', name: 'Antminer L3+', manufacturer: 'Bitmain', hashrate: 504, unit: 'MH/s', power: 800, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'l3-plusplus', name: 'Antminer L3++', manufacturer: 'Bitmain', hashrate: 596, unit: 'MH/s', power: 942, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: false },
      
      // LOKI - Scrypt
      { id: 'l7-9500-loki', name: 'L7 9500M (Loki)', manufacturer: 'Bitmain', hashrate: 3800, unit: 'MH/s', power: 1200, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: true },
      
      // NATIVE 120V - KHeavyHash (IceRiver compact/home miners)
      { id: 'ks0', name: 'KS0', manufacturer: 'IceRiver', hashrate: 100, unit: 'GH/s', power: 65, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ks0-pro', name: 'KS0 Pro', manufacturer: 'IceRiver', hashrate: 200, unit: 'GH/s', power: 100, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ks0-ultra', name: 'KS0 Ultra', manufacturer: 'IceRiver', hashrate: 400, unit: 'GH/s', power: 100, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ks1', name: 'KS1', manufacturer: 'IceRiver', hashrate: 1000, unit: 'GH/s', power: 600, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ks2', name: 'KS2', manufacturer: 'IceRiver', hashrate: 2000, unit: 'GH/s', power: 1200, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'ks2-lite', name: 'KS2 Lite', manufacturer: 'IceRiver', hashrate: 2000, unit: 'GH/s', power: 500, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ks7-lite', name: 'KS7 Lite', manufacturer: 'IceRiver', hashrate: 4200, unit: 'GH/s', power: 500, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Room Temp', loki: false },
      // NATIVE 120V - KHeavyHash (Goldshell compact/home miners)
      { id: 'ka-box', name: 'KA Box', manufacturer: 'Goldshell', hashrate: 1180, unit: 'GH/s', power: 400, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'vacuum', noiseLabel: 'Loud (50-70 dB)', cooling: 'Room Temp', loki: false },
      { id: 'ka-box-pro', name: 'KA Box Pro', manufacturer: 'Goldshell', hashrate: 1600, unit: 'GH/s', power: 600, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
      
      // NATIVE 120V - Etchash (ETC)
      { id: 'ipollo-v1-mini', name: 'iPollo V1 Mini', manufacturer: 'iPollo', hashrate: 130, unit: 'MH/s', power: 240, algorithm: 'Etchash', coins: ['ETC'], category: null, voltage: '120V', noise: 'fan', noiseLabel: 'Fan (30-50 dB)', cooling: 'Room Temp', loki: false },
    ];
    
    // ============================================
    // MINER DATABASE - 240V (Full Power)
    // ============================================
    const MINERS_240V = [
      // SHA-256
      { id: 's19-82t', name: 'Antminer S19 82T', manufacturer: 'Bitmain', hashrate: 82, unit: 'TH/s', power: 2829, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-86t', name: 'Antminer S19 86T', manufacturer: 'Bitmain', hashrate: 86, unit: 'TH/s', power: 2967, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-90t', name: 'Antminer S19 90T', manufacturer: 'Bitmain', hashrate: 90, unit: 'TH/s', power: 3100, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-95t', name: 'Antminer S19 95T', manufacturer: 'Bitmain', hashrate: 95, unit: 'TH/s', power: 3250, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-pro-100t', name: 'Antminer S19 Pro 100T', manufacturer: 'Bitmain', hashrate: 100, unit: 'TH/s', power: 3050, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-pro-110t', name: 'Antminer S19 Pro 110T', manufacturer: 'Bitmain', hashrate: 110, unit: 'TH/s', power: 3250, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-90t', name: 'Antminer S19J 90T', manufacturer: 'Bitmain', hashrate: 90, unit: 'TH/s', power: 3250, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-100t', name: 'Antminer S19J 100T', manufacturer: 'Bitmain', hashrate: 100, unit: 'TH/s', power: 3100, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-104t', name: 'Antminer S19J 104T', manufacturer: 'Bitmain', hashrate: 104, unit: 'TH/s', power: 3068, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-pro-96t', name: 'Antminer S19J Pro 96T', manufacturer: 'Bitmain', hashrate: 96, unit: 'TH/s', power: 2832, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-pro-100t', name: 'Antminer S19J Pro 100T', manufacturer: 'Bitmain', hashrate: 100, unit: 'TH/s', power: 2950, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-pro-104t', name: 'Antminer S19J Pro 104T', manufacturer: 'Bitmain', hashrate: 104, unit: 'TH/s', power: 3068, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19k-pro-120t', name: 'Antminer S19K Pro 120T', manufacturer: 'Bitmain', hashrate: 120, unit: 'TH/s', power: 2760, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19k-pro-136t', name: 'Antminer S19K Pro 136T', manufacturer: 'Bitmain', hashrate: 136, unit: 'TH/s', power: 3264, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19-xp-140t', name: 'Antminer S19 XP 140T', manufacturer: 'Bitmain', hashrate: 140, unit: 'TH/s', power: 3010, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's19j-xp-151t', name: 'Antminer S19J XP 151T', manufacturer: 'Bitmain', hashrate: 151, unit: 'TH/s', power: 3247, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's21-200t', name: 'Antminer S21 200T', manufacturer: 'Bitmain', hashrate: 200, unit: 'TH/s', power: 3500, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's21-pro-234t', name: 'Antminer S21 Pro 234T', manufacturer: 'Bitmain', hashrate: 234, unit: 'TH/s', power: 3510, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 's21-xp-270t', name: 'Antminer S21 XP 270T', manufacturer: 'Bitmain', hashrate: 270, unit: 'TH/s', power: 3645, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      // Whatsminer SHA-256
      { id: 'm30s-pp-112t', name: 'Whatsminer M30S++ 112T', manufacturer: 'MicroBT', hashrate: 112, unit: 'TH/s', power: 3472, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'm50-118t', name: 'Whatsminer M50 118T', manufacturer: 'MicroBT', hashrate: 118, unit: 'TH/s', power: 3306, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'm50s-126t', name: 'Whatsminer M50S 126T', manufacturer: 'MicroBT', hashrate: 126, unit: 'TH/s', power: 3276, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'm50s-pp-140t', name: 'Whatsminer M50S++ 140T', manufacturer: 'MicroBT', hashrate: 140, unit: 'TH/s', power: 3080, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'm60-170t', name: 'Whatsminer M60 170T', manufacturer: 'MicroBT', hashrate: 170, unit: 'TH/s', power: 3383, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'm60s-186t', name: 'Whatsminer M60S 186T', manufacturer: 'MicroBT', hashrate: 186, unit: 'TH/s', power: 3441, algorithm: 'SHA-256', coins: ['BTC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      
      // Scrypt
      { id: 'l7-9050', name: 'Antminer L7 9050M', manufacturer: 'Bitmain', hashrate: 9050, unit: 'MH/s', power: 3260, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'l7-9500', name: 'Antminer L7 9500M', manufacturer: 'Bitmain', hashrate: 9500, unit: 'MH/s', power: 3425, algorithm: 'Scrypt', coins: ['LTC', 'DOGE'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      
      // KHeavyHash (IceRiver industrial miners)
      { id: 'ks3', name: 'KS3', manufacturer: 'IceRiver', hashrate: 8000, unit: 'GH/s', power: 3200, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'ks3m', name: 'KS3M', manufacturer: 'IceRiver', hashrate: 6000, unit: 'GH/s', power: 3400, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'ks5l', name: 'KS5L', manufacturer: 'IceRiver', hashrate: 12000, unit: 'GH/s', power: 3400, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'ks5m', name: 'KS5M', manufacturer: 'IceRiver', hashrate: 15000, unit: 'GH/s', power: 3400, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      // KHeavyHash (Bitmain Antminer KS series)
      { id: 'antminer-ks3', name: 'Antminer KS3', manufacturer: 'Bitmain', hashrate: 9400, unit: 'GH/s', power: 3500, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'antminer-ks5', name: 'Antminer KS5', manufacturer: 'Bitmain', hashrate: 20000, unit: 'GH/s', power: 3000, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'antminer-ks5-pro', name: 'Antminer KS5 Pro', manufacturer: 'Bitmain', hashrate: 21000, unit: 'GH/s', power: 3150, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'antminer-ks7', name: 'Antminer KS7', manufacturer: 'Bitmain', hashrate: 40000, unit: 'GH/s', power: 3080, algorithm: 'KHeavyHash', coins: ['KAS'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      
      // Etchash (ETC)
      { id: 'e9-pro', name: 'E9 Pro', manufacturer: 'Bitmain', hashrate: 3680, unit: 'MH/s', power: 2200, algorithm: 'Etchash', coins: ['ETC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      
      // Equihash (ZEC)
      { id: 'z15', name: 'Antminer Z15', manufacturer: 'Bitmain', hashrate: 420, unit: 'kSol/s', power: 1510, algorithm: 'Equihash', coins: ['ZEC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      { id: 'z15-pro', name: 'Antminer Z15 Pro', manufacturer: 'Bitmain', hashrate: 840, unit: 'kSol/s', power: 2560, algorithm: 'Equihash', coins: ['ZEC'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
      
      // X11 (DASH)
      { id: 'd9', name: 'Antminer D9', manufacturer: 'Bitmain', hashrate: 1770, unit: 'GH/s', power: 2839, algorithm: 'X11', coins: ['DASH'], category: null, voltage: '240V', noise: 'lawnmower', noiseLabel: 'Very Loud (75+ dB)', cooling: 'Needs Ventilation', loki: false },
    ];
    
    // Combined for "All" filter and browse table
    const ALL_MINERS = [...MINERS_120V, ...MINERS_240V];
    
    // Prices & Rates - Updated via CoinGecko API, these are fallback defaults
    const DEFAULT_PRICES = { 
      BTC: 89000, BCH: 590, LTC: 69, KAS: 0.10, ETC: 28, DOGE: 0.12,
      ZEC: 45, DASH: 44, RVN: 0.007, ERG: 0.45, ALPH: 0.11, XMR: 200
    };
    let PRICES = { ...DEFAULT_PRICES };
    let priceStatus = 'default'; // 'live', 'cached', 'default'
    let lastPriceUpdate = null;
    
    // Revenue rates per unit per day (coins earned)
    // Updated January 2026 based on current network difficulty
    // Sources: CoinWarz, MinerStat, WhatToMine
    const REVENUE_RATES = {
      // ASIC Algorithms
      // BTC: 390 TH/s = 5,974 days for 1 BTC ‚Üí 0.00000043 BTC/TH/day
      'SHA-256': { perUnit: 0.00000043, unit: 'TH/s', coin: 'BTC' },
      // BCH: 390 TH/s = 36.4 days for 1 BCH ‚Üí 0.0000703 BCH/TH/day
      'SHA-256-BCH': { perUnit: 0.0000703, unit: 'TH/s', coin: 'BCH' },
      // Scrypt is MERGED MINING - you get BOTH LTC and DOGE simultaneously
      // LTC: 17,000 MH/s = 0.0207 LTC/day ‚Üí 0.00000122 LTC/MH/day
      'Scrypt': { 
        perUnit: 0.00000122, unit: 'MH/s', coin: 'LTC',
        merged: { perUnit: 0.00459, coin: 'DOGE' }
      },
      // KAS: Kaspa - verified against CryptoCompare Jan 2026
      // 21 TH/s = 135.7 KAS/day ‚Üí 0.00646 KAS/GH/s/day
      'KHeavyHash': { perUnit: 0.00646, unit: 'GH/s', coin: 'KAS' },
      // ETC: 5,800 MH/s = 0.625 ETC/day ‚Üí 0.000108 ETC/MH/day
      'Etchash': { perUnit: 0.000108, unit: 'MH/s', coin: 'ETC' },
      // ZEC: 140 KH/s = 0.0133 ZEC/day ‚Üí 0.000095 ZEC/KSol/day
      'Equihash': { perUnit: 0.000095, unit: 'kSol/s', coin: 'ZEC' },
      // DASH: 65 GH/s = 0.0174 DASH/day ‚Üí 0.000268 DASH/GH/day
      'X11': { perUnit: 0.000268, unit: 'GH/s', coin: 'DASH' },
      // GPU Algorithms
      'Etchash-GPU': { perUnit: 0.000108, unit: 'MH/s', coin: 'ETC' },
      // RVN: 350 MH/s = 228 RVN/day ‚Üí 0.65 RVN/MH/day (halving Jan 2026 reduces block to 1250)
      'KAWPOW': { perUnit: 0.65, unit: 'MH/s', coin: 'RVN' },
      // ERG: Autolykos v2, GPU-friendly
      'Autolykos2': { perUnit: 0.0027, unit: 'MH/s', coin: 'ERG' },
      // ALPH: ASIC-dominated, ~12 PH/s network
      'Blake3': { perUnit: 0.00001, unit: 'GH/s', coin: 'ALPH' },
      // CPU Algorithms  
      // XMR: 54 KH/s = 0.00355 XMR/day ‚Üí 0.0000658 XMR/KH/day
      'RandomX': { perUnit: 0.0000658, unit: 'KH/s', coin: 'XMR' }
    };
    
    // Algorithm configurations by mining type
    const ALGORITHM_CONFIG = {
      ASIC: [
        { value: 'all', label: 'All Algorithms' },
        { value: 'SHA-256', label: 'SHA-256 (BTC)' },
        { value: 'SHA-256-BCH', label: 'SHA-256 (BCH)' },
        { value: 'Scrypt', label: 'Scrypt (LTC+DOGE)' },
        { value: 'KHeavyHash', label: 'KHeavyHash (KAS)' },
        { value: 'Etchash', label: 'Etchash (ETC)' },
        { value: 'Equihash', label: 'Equihash (ZEC)' },
        { value: 'X11', label: 'X11 (DASH)' }
      ],
      GPU: [
        { value: 'Etchash-GPU', label: 'Etchash (ETC)', unit: 'MH/s' },
        { value: 'KAWPOW', label: 'KAWPOW (RVN)', unit: 'MH/s' },
        { value: 'Autolykos2', label: 'Autolykos v2 (ERG)', unit: 'MH/s' },
        { value: 'Blake3', label: 'Blake3 (ALPH)', unit: 'GH/s' }
      ],
      CPU: [
        { value: 'RandomX', label: 'RandomX (XMR)', unit: 'KH/s' }
      ]
    };
    
    // State
    let selectedMiner = null;
    let sortDirection = 1;
    
    // ============================================
    // UTILITIES
    // ============================================
    function getDailyCost(power) {
      return (power / 1000) * 24 * 0.15;
    }
    
    function getNoiseIcon(noise) {
      const icons = { silent: 'üîá', fan: 'üîà', vacuum: 'üîâ', lawnmower: 'üîä' };
      return icons[noise] || 'üîà';
    }
    
    // ============================================
    // LIVE PRICE FETCHING (CoinGecko API)
    // ============================================
    const COINGECKO_IDS = {
      BTC: 'bitcoin',
      BCH: 'bitcoin-cash',
      LTC: 'litecoin',
      KAS: 'kaspa',
      ETC: 'ethereum-classic',
      DOGE: 'dogecoin',
      ZEC: 'zcash',
      DASH: 'dash',
      RVN: 'ravencoin',
      ERG: 'ergo',
      ALPH: 'alephium',
      XMR: 'monero'
    };
    
    async function fetchPrices() {
      const ids = Object.values(COINGECKO_IDS).join(',');
      const url = `https://api.coingecko.com/api/v3/simple/price?ids=${ids}&vs_currencies=usd`;
      
      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error('API request failed');
        
        const data = await response.json();
        
        // Map CoinGecko response to our PRICES object
        PRICES.BTC = data.bitcoin?.usd || PRICES.BTC;
        PRICES.BCH = data['bitcoin-cash']?.usd || PRICES.BCH;
        PRICES.LTC = data.litecoin?.usd || PRICES.LTC;
        PRICES.KAS = data.kaspa?.usd || PRICES.KAS;
        PRICES.ETC = data['ethereum-classic']?.usd || PRICES.ETC;
        PRICES.DOGE = data.dogecoin?.usd || PRICES.DOGE;
        PRICES.ZEC = data.zcash?.usd || PRICES.ZEC;
        PRICES.DASH = data.dash?.usd || PRICES.DASH;
        PRICES.RVN = data.ravencoin?.usd || PRICES.RVN;
        PRICES.ERG = data.ergo?.usd || PRICES.ERG;
        PRICES.ALPH = data.alephium?.usd || PRICES.ALPH;
        PRICES.XMR = data.monero?.usd || PRICES.XMR;
        
        // Save to localStorage with timestamp
        const cacheData = {
          prices: { ...PRICES },
          timestamp: Date.now()
        };
        localStorage.setItem('solaray_prices', JSON.stringify(cacheData));
        
        priceStatus = 'live';
        lastPriceUpdate = new Date();
        updatePriceIndicator();
        
        console.log('Live prices fetched:', PRICES);
        return true;
      } catch (error) {
        console.warn('Failed to fetch live prices:', error);
        return false;
      }
    }
    
    function loadCachedPrices() {
      try {
        const cached = localStorage.getItem('solaray_prices');
        if (cached) {
          const data = JSON.parse(cached);
          PRICES = { ...data.prices };
          lastPriceUpdate = new Date(data.timestamp);
          priceStatus = 'cached';
          updatePriceIndicator();
          console.log('Loaded cached prices from:', lastPriceUpdate);
          return true;
        }
      } catch (error) {
        console.warn('Failed to load cached prices:', error);
      }
      return false;
    }
    
    function updatePriceIndicator() {
      const indicator = document.getElementById('price-indicator');
      if (!indicator) return;
      
      if (priceStatus === 'live') {
        indicator.innerHTML = 'üü¢ Live Prices';
        indicator.className = 'price-indicator live';
      } else if (priceStatus === 'cached') {
        const ago = getTimeAgo(lastPriceUpdate);
        indicator.innerHTML = `üü° Cached (${ago})`;
        indicator.className = 'price-indicator cached';
      } else {
        indicator.innerHTML = 'üî¥ Default Prices';
        indicator.className = 'price-indicator default';
      }
      
      // Also update the live price display if visible
      if (typeof updateLivePriceDisplay === 'function') {
        updateLivePriceDisplay();
      }
    }
    
    function getTimeAgo(date) {
      const seconds = Math.floor((new Date() - date) / 1000);
      if (seconds < 60) return 'just now';
      if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';
      if (seconds < 86400) return Math.floor(seconds / 3600) + 'h ago';
      return Math.floor(seconds / 86400) + 'd ago';
    }
    
    async function initPrices() {
      // Try to fetch live prices first
      const liveSuccess = await fetchPrices();
      
      // If live fetch failed, try to load from cache
      if (!liveSuccess) {
        const cacheLoaded = loadCachedPrices();
        if (!cacheLoaded) {
          // Use defaults (already set)
          priceStatus = 'default';
          updatePriceIndicator();
        }
      }
      
      // Set up auto-refresh every 60 seconds
      setInterval(fetchPrices, 60000);
    }
    
    // ============================================
    // DROPDOWN LOGIC
    // ============================================
    function getFilteredMiners() {
      const voltageFilter = document.getElementById('voltage-filter').value;
      
      if (voltageFilter === '120V') return MINERS_120V;
      if (voltageFilter === '240V') return MINERS_240V;
      return ALL_MINERS;
    }
    
    // Track custom price overrides per coin
    let customPrices = {};
    let currentDisplayedCoin = null;
    
    function updateLivePriceDisplay() {
      const algoFilter = document.getElementById('algorithm-filter').value;
      const display = document.getElementById('live-price-display');
      const coinEl = document.getElementById('live-price-coin');
      const inputEl = document.getElementById('live-price-input');
      const statusEl = document.getElementById('live-price-status');
      const resetBtn = document.getElementById('price-reset-btn');
      
      // Map algorithm to coin
      const algoCoinMap = {
        'SHA-256': 'BTC',
        'SHA-256-BCH': 'BCH',
        'Scrypt': 'LTC',
        'KHeavyHash': 'KAS',
        'Etchash': 'ETC',
        'Etchash-GPU': 'ETC',
        'Equihash': 'ZEC',
        'X11': 'DASH',
        'KAWPOW': 'RVN',
        'Autolykos2': 'ERG',
        'Blake3': 'ALPH',
        'RandomX': 'XMR'
      };
      
      if (algoFilter === 'all') {
        display.style.display = 'none';
        return;
      }
      
      const coin = algoCoinMap[algoFilter];
      if (!coin) {
        display.style.display = 'none';
        return;
      }
      
      currentDisplayedCoin = coin;
      const livePrice = PRICES[coin] || 0;
      const hasCustomPrice = customPrices.hasOwnProperty(coin);
      const displayPrice = hasCustomPrice ? customPrices[coin] : livePrice;
      
      coinEl.textContent = coin;
      inputEl.value = displayPrice >= 1 ? displayPrice.toLocaleString('en-US', {maximumFractionDigits: 2}) : displayPrice.toFixed(4);
      
      // Update status indicator and styling based on custom vs live
      if (hasCustomPrice) {
        statusEl.textContent = 'üü£ Custom';
        statusEl.className = 'live-price-status custom';
        inputEl.classList.add('custom-price');
        resetBtn.style.display = 'inline-block';
      } else if (priceStatus === 'live') {
        statusEl.textContent = 'üü¢ Live';
        statusEl.className = 'live-price-status';
        inputEl.classList.remove('custom-price');
        resetBtn.style.display = 'none';
      } else if (priceStatus === 'cached') {
        const ago = getTimeAgo(lastPriceUpdate);
        statusEl.textContent = `üü° ${ago}`;
        statusEl.className = 'live-price-status cached';
        inputEl.classList.remove('custom-price');
        resetBtn.style.display = 'none';
      } else {
        statusEl.textContent = 'üî¥ Default';
        statusEl.className = 'live-price-status default';
        inputEl.classList.remove('custom-price');
        resetBtn.style.display = 'none';
      }
      
      display.style.display = 'flex';
    }
    
    // Get the effective price for calculations (custom or live)
    function getEffectivePrice(coin) {
      if (customPrices.hasOwnProperty(coin)) {
        return customPrices[coin];
      }
      return PRICES[coin] || 0;
    }
    
    // Handle custom price input
    function initPriceInput() {
      const inputEl = document.getElementById('live-price-input');
      const resetBtn = document.getElementById('price-reset-btn');
      
      inputEl.addEventListener('change', function() {
        if (!currentDisplayedCoin) return;
        
        // Parse the entered value (remove commas)
        let newPrice = parseFloat(this.value.replace(/,/g, ''));
        if (isNaN(newPrice) || newPrice < 0) {
          // Invalid input - reset to current
          updateLivePriceDisplay();
          return;
        }
        
        // Store custom price
        customPrices[currentDisplayedCoin] = newPrice;
        updateLivePriceDisplay();
        
        // Recalculate if a miner is selected
        if (selectedMiner) {
          calculate();
        }
      });
      
      inputEl.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          this.blur();
        }
      });
      
      resetBtn.addEventListener('click', function() {
        if (!currentDisplayedCoin) return;
        
        // Remove custom price override
        delete customPrices[currentDisplayedCoin];
        updateLivePriceDisplay();
        
        // Recalculate if a miner is selected
        if (selectedMiner) {
          calculate();
        }
      });
    }
    
    function updateMinerDropdown() {
      const algoFilter = document.getElementById('algorithm-filter').value;
      const minerSelect = document.getElementById('miner-select');
      
      let miners = getFilteredMiners();
      
      if (algoFilter !== 'all') {
        // SHA-256-BCH uses same miners as SHA-256 (BTC)
        const filterAlgo = algoFilter === 'SHA-256-BCH' ? 'SHA-256' : algoFilter;
        miners = miners.filter(m => m.algorithm === filterAlgo);
      }
      
      minerSelect.innerHTML = '<option value="">-- Select Miner --</option>';
      miners.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m.id;
        opt.textContent = m.name;
        // Style Loki miners purple
        if (m.loki) {
          opt.style.color = '#9c27b0';
        }
        minerSelect.appendChild(opt);
      });
      
      // Update live price display
      updateLivePriceDisplay();
      
      // Clear selection
      document.getElementById('miner-info').classList.remove('active');
      document.getElementById('miner-info').classList.remove('loki-miner');
      selectedMiner = null;
    }
    
    // ============================================
    // MINING TYPE LOGIC (ASIC/GPU/CPU)
    // ============================================
    let currentMiningType = 'ASIC';
    
    function updateMiningType() {
      const miningType = document.getElementById('mining-type-filter').value;
      currentMiningType = miningType;
      
      const voltageGroup = document.getElementById('voltage-group');
      const minerRow = document.getElementById('miner-row');
      const minerInfo = document.getElementById('miner-info');
      const manualSection = document.getElementById('manual-input-section');
      const algoSelect = document.getElementById('algorithm-filter');
      
      if (miningType === 'ASIC') {
        // Show ASIC-specific controls
        voltageGroup.style.display = 'flex';
        minerRow.style.display = 'grid';
        manualSection.style.display = 'none';
        
        // Populate algorithm dropdown for ASIC
        algoSelect.innerHTML = '';
        ALGORITHM_CONFIG.ASIC.forEach(algo => {
          const opt = document.createElement('option');
          opt.value = algo.value;
          opt.textContent = algo.label;
          algoSelect.appendChild(opt);
        });
        
        updateMinerDropdown();
      } else {
        // GPU or CPU - hide ASIC controls, show manual input
        voltageGroup.style.display = 'none';
        minerRow.style.display = 'none';
        minerInfo.classList.remove('active');
        minerInfo.classList.remove('loki-miner');
        manualSection.style.display = 'block';
        selectedMiner = null;
        
        // Update title
        const title = document.getElementById('manual-input-title');
        title.textContent = miningType === 'GPU' ? 'üéÆ GPU Mining Setup' : 'üíª CPU Mining Setup';
        
        // Populate algorithm dropdown for GPU/CPU
        const algos = ALGORITHM_CONFIG[miningType];
        algoSelect.innerHTML = '';
        algos.forEach((algo, idx) => {
          const opt = document.createElement('option');
          opt.value = algo.value;
          opt.textContent = algo.label;
          algoSelect.appendChild(opt);
        });
        
        // Update unit label based on first algorithm
        if (algos.length > 0) {
          document.getElementById('manual-unit-label').textContent = algos[0].unit;
        }
        
        updateLivePriceDisplay();
      }
    }
    
    function updateManualUnit() {
      const algoFilter = document.getElementById('algorithm-filter').value;
      const miningType = document.getElementById('mining-type-filter').value;
      
      if (miningType === 'GPU' || miningType === 'CPU') {
        const algos = ALGORITHM_CONFIG[miningType];
        const selectedAlgo = algos.find(a => a.value === algoFilter);
        if (selectedAlgo) {
          document.getElementById('manual-unit-label').textContent = selectedAlgo.unit;
        }
        updateLivePriceDisplay();
      }
    }
    
    function selectMiner() {
      const id = document.getElementById('miner-select').value;
      if (!id) {
        document.getElementById('miner-info').classList.remove('active');
        document.getElementById('miner-info').classList.remove('loki-miner');
        selectedMiner = null;
        return;
      }
      
      selectedMiner = ALL_MINERS.find(m => m.id === id);
      if (!selectedMiner) return;
      
      const infoCard = document.getElementById('miner-info');
      infoCard.classList.add('active');
      infoCard.classList.toggle('loki-miner', selectedMiner.loki);
      
      const nameEl = document.getElementById('info-name');
      nameEl.textContent = selectedMiner.name;
      nameEl.classList.toggle('loki', selectedMiner.loki);
      
      document.getElementById('info-manufacturer').textContent = selectedMiner.manufacturer;
      document.getElementById('info-hashrate').textContent = `${selectedMiner.hashrate} ${selectedMiner.unit}`;
      document.getElementById('info-power').textContent = selectedMiner.power + 'W';
      
      const voltageEl = document.getElementById('info-voltage');
      voltageEl.textContent = selectedMiner.voltage;
      voltageEl.className = 'spec-value ' + (selectedMiner.voltage === '120V' ? 'v120' : 'v240');
      
      document.getElementById('info-noise').textContent = getNoiseIcon(selectedMiner.noise) + ' ' + selectedMiner.noiseLabel;
      document.getElementById('info-cooling').textContent = selectedMiner.cooling;
      document.getElementById('info-coins').textContent = selectedMiner.coins.join(', ');
      document.getElementById('info-runcost').textContent = `‚ö° $${getDailyCost(selectedMiner.power).toFixed(2)}/day to run`;
      
      // Badges
      document.getElementById('info-lottery').style.display = selectedMiner.category === 'lottery' ? 'inline' : 'none';
      document.getElementById('info-loki-badge').style.display = selectedMiner.loki ? 'inline' : 'none';
      
      // Loki notice
      document.getElementById('loki-notice').style.display = selectedMiner.loki ? 'block' : 'none';
      
      // Config inputs
      document.getElementById('config-hashrate').value = selectedMiner.hashrate;
      document.getElementById('config-power').value = selectedMiner.power;
    }
    
    // ============================================
    // RESET
    // ============================================
    function resetCalculator() {
      document.getElementById('mining-type-filter').value = 'ASIC';
      document.getElementById('voltage-filter').value = 'all';
      document.getElementById('algorithm-filter').value = 'all';
      document.getElementById('miner-select').value = '';
      document.getElementById('miner-info').classList.remove('active');
      document.getElementById('miner-info').classList.remove('loki-miner');
      document.getElementById('miner-cost').value = '0';
      document.getElementById('solar-hours').value = '6';
      document.getElementById('free-hours').value = '6';
      document.getElementById('battery-hours').value = '0';
      document.getElementById('idle-hours').value = '0';
      document.getElementById('grid-rate').value = '0.15';
      document.getElementById('pool-fee').value = '1';
      document.getElementById('use-aftermarket').checked = false;
      document.getElementById('dev-fee').value = '2';
      document.getElementById('dev-fee-wrapper').style.display = 'none';
      document.getElementById('results-panel').classList.remove('active');
      // Reset manual input fields
      document.getElementById('manual-hashrate').value = '';
      document.getElementById('manual-power').value = '';
      document.getElementById('manual-cost').value = '0';
      document.getElementById('manual-input-section').style.display = 'none';
      document.getElementById('voltage-group').style.display = 'flex';
      document.getElementById('miner-row').style.display = 'grid';
      selectedMiner = null;
      currentMiningType = 'ASIC';
      updateMiningType();
      updateTimeline();
    }
    
    // ============================================
    // DEV FEE TOGGLE
    // ============================================
    function toggleDevFee() {
      const checkbox = document.getElementById('use-aftermarket');
      const wrapper = document.getElementById('dev-fee-wrapper');
      wrapper.style.display = checkbox.checked ? 'flex' : 'none';
    }
    
    // ============================================
    // CAP HOURS TO 24 TOTAL
    // ============================================
    function capHours(changedInput) {
      const solar = parseInt(document.getElementById('solar-hours').value) || 0;
      const free = parseInt(document.getElementById('free-hours').value) || 0;
      const battery = parseInt(document.getElementById('battery-hours').value) || 0;
      const idle = parseInt(document.getElementById('idle-hours').value) || 0;
      const total = solar + free + battery + idle;
      
      if (total > 24) {
        const excess = total - 24;
        const currentVal = parseInt(changedInput.value) || 0;
        changedInput.value = Math.max(0, currentVal - excess);
      }
      updateTimeline();
    }
    
    // ============================================
    // TIMELINE (with idle time)
    // ============================================
    function updateTimeline() {
      const solar = parseInt(document.getElementById('solar-hours').value) || 0;
      const free = parseInt(document.getElementById('free-hours').value) || 0;
      const battery = parseInt(document.getElementById('battery-hours').value) || 0;
      const idle = parseInt(document.getElementById('idle-hours').value) || 0;
      const gridRate = parseFloat(document.getElementById('grid-rate').value) || 0.15;
      const grid = Math.max(0, 24 - solar - free - battery - idle);
      
      document.getElementById('grid-rate-display').textContent = gridRate.toFixed(2);
      
      const timeline = document.getElementById('timeline');
      timeline.innerHTML = '';
      
      if (solar > 0) {
        const seg = document.createElement('div');
        seg.className = 'timeline-segment timeline-solar';
        seg.style.flex = solar;
        seg.textContent = `‚òÄÔ∏è ${solar}h`;
        timeline.appendChild(seg);
      }
      if (free > 0) {
        const seg = document.createElement('div');
        seg.className = 'timeline-segment timeline-free';
        seg.style.flex = free;
        seg.textContent = `üåô ${free}h`;
        timeline.appendChild(seg);
      }
      if (battery > 0) {
        const seg = document.createElement('div');
        seg.className = 'timeline-segment timeline-battery';
        seg.style.flex = battery;
        seg.textContent = `üîã ${battery}h`;
        timeline.appendChild(seg);
      }
      if (grid > 0) {
        const seg = document.createElement('div');
        seg.className = 'timeline-segment timeline-grid';
        seg.style.flex = grid;
        seg.textContent = `‚ö° ${grid}h`;
        timeline.appendChild(seg);
      }
      if (idle > 0) {
        const seg = document.createElement('div');
        seg.className = 'timeline-segment timeline-idle';
        seg.style.flex = idle;
        seg.textContent = `‚è∏Ô∏è ${idle}h`;
        timeline.appendChild(seg);
      }
    }
    
    // ============================================
    // CALCULATE (with idle time affecting revenue)
    // ============================================
    function calculate() {
      const miningType = document.getElementById('mining-type-filter').value;
      
      let hashrate, power, cost, algorithm;
      
      if (miningType === 'ASIC') {
        // ASIC mode - use selected miner
        if (!selectedMiner) {
          alert('Please select a miner first.');
          return;
        }
        hashrate = parseFloat(document.getElementById('config-hashrate').value) || selectedMiner.hashrate;
        power = parseFloat(document.getElementById('config-power').value) || selectedMiner.power;
        cost = parseFloat(document.getElementById('miner-cost').value) || 0;
        
        // Use algorithm filter to determine coin (for BCH vs BTC)
        const algoFilter = document.getElementById('algorithm-filter').value;
        algorithm = (algoFilter === 'SHA-256-BCH') ? 'SHA-256-BCH' : selectedMiner.algorithm;
      } else {
        // GPU/CPU mode - use manual input
        hashrate = parseFloat(document.getElementById('manual-hashrate').value);
        power = parseFloat(document.getElementById('manual-power').value);
        cost = parseFloat(document.getElementById('manual-cost').value) || 0;
        algorithm = document.getElementById('algorithm-filter').value;
        
        if (!hashrate || hashrate <= 0) {
          alert('Please enter your hashrate.');
          return;
        }
        if (!power || power <= 0) {
          alert('Please enter your power consumption.');
          return;
        }
      }
      
      const solarHours = parseInt(document.getElementById('solar-hours').value) || 0;
      const freeHours = parseInt(document.getElementById('free-hours').value) || 0;
      const batteryHours = parseInt(document.getElementById('battery-hours').value) || 0;
      const idleHours = parseInt(document.getElementById('idle-hours').value) || 0;
      const gridRate = parseFloat(document.getElementById('grid-rate').value) || 0.15;
      const poolFee = parseFloat(document.getElementById('pool-fee').value) || 1;
      const useAftermarket = document.getElementById('use-aftermarket').checked;
      const devFee = useAftermarket ? (parseFloat(document.getElementById('dev-fee').value) || 2) : 0;
      const totalFees = poolFee + devFee;
      const gridHours = Math.max(0, 24 - solarHours - freeHours - batteryHours - idleHours);
      
      // Active mining hours (excludes idle)
      const activeHours = 24 - idleHours;
      const activeFraction = activeHours / 24;
      
      // Electricity (only paid during grid hours, no cost during idle)
      const kW = power / 1000;
      const paidKWh = kW * gridHours;
      const dailyElecCost = paidKWh * gridRate;
      
      // Revenue
      const rateInfo = REVENUE_RATES[algorithm];
      if (!rateInfo) {
        alert('Algorithm not supported. Please select a valid algorithm.');
        return;
      }
      
      // Calculate primary coin
      const fullDailyCrypto = hashrate * rateInfo.perUnit;
      const dailyCrypto = fullDailyCrypto * activeFraction;
      const coinPrice = getEffectivePrice(rateInfo.coin);
      let dailyRevenue = dailyCrypto * coinPrice * (1 - totalFees / 100);
      
      // Handle merged mining (Scrypt = LTC + DOGE)
      let dailyMergedCrypto = 0;
      let mergedCoin = '';
      let mergedCoinPrice = 0;
      if (rateInfo.merged) {
        const fullDailyMerged = hashrate * rateInfo.merged.perUnit;
        dailyMergedCrypto = fullDailyMerged * activeFraction;
        mergedCoin = rateInfo.merged.coin;
        mergedCoinPrice = getEffectivePrice(mergedCoin);
        dailyRevenue += dailyMergedCrypto * mergedCoinPrice * (1 - totalFees / 100);
      }
      
      const dailyProfit = dailyRevenue - dailyElecCost;
      
      // Periods
      const monthly = (v) => v * 30;
      const yearly = (v) => v * 365;
      
      // ROI & Electricity Stats
      const monthlyProfit = monthly(dailyProfit);
      const breakevenDays = cost > 0 && dailyProfit > 0 ? Math.ceil(cost / dailyProfit) : (dailyProfit <= 0 ? Infinity : 0);
      const annualElecCost = yearly(dailyElecCost);
      const fullGridCost = kW * 24 * gridRate * 365; // What 24/7 grid would cost
      const annualElecSavings = fullGridCost - annualElecCost;
      
      // Update DOM
      document.getElementById('results-panel').classList.add('active');
      
      document.getElementById('breakeven-days').textContent = breakevenDays === Infinity ? '‚àû' : (breakevenDays === 0 ? 'N/A' : breakevenDays);
      document.getElementById('annual-elec-cost').textContent = `$${annualElecCost.toFixed(0)}`;
      document.getElementById('annual-elec-savings').textContent = `$${annualElecSavings.toFixed(0)}`;
      
      document.getElementById('daily-revenue').textContent = `$${dailyRevenue.toFixed(2)}`;
      document.getElementById('daily-elec').textContent = `$${dailyElecCost.toFixed(2)}`;
      document.getElementById('daily-profit').textContent = `$${dailyProfit.toFixed(2)}`;
      
      // Format crypto output - show merged mining if applicable
      if (rateInfo.merged) {
        document.getElementById('daily-crypto').textContent = `${dailyCrypto.toFixed(8)} ${rateInfo.coin} + ${dailyMergedCrypto.toFixed(4)} ${mergedCoin}`;
        document.getElementById('monthly-crypto').textContent = `${monthly(dailyCrypto).toFixed(6)} ${rateInfo.coin} + ${monthly(dailyMergedCrypto).toFixed(1)} ${mergedCoin}`;
        document.getElementById('yearly-crypto').textContent = `${yearly(dailyCrypto).toFixed(4)} ${rateInfo.coin} + ${Math.round(yearly(dailyMergedCrypto)).toLocaleString()} ${mergedCoin}`;
        document.getElementById('price-note').textContent = `Prices: ${rateInfo.coin} $${coinPrice.toLocaleString()} | ${mergedCoin} $${mergedCoinPrice.toFixed(4)} | Mining ${activeHours}h/day`;
      } else {
        document.getElementById('daily-crypto').textContent = `${dailyCrypto.toFixed(8)} ${rateInfo.coin}`;
        document.getElementById('monthly-crypto').textContent = `${monthly(dailyCrypto).toFixed(6)} ${rateInfo.coin}`;
        document.getElementById('yearly-crypto').textContent = `${yearly(dailyCrypto).toFixed(4)} ${rateInfo.coin}`;
        document.getElementById('price-note').textContent = `Prices: ${rateInfo.coin} $${coinPrice.toLocaleString()} | Mining ${activeHours}h/day`;
      }
      
      document.getElementById('monthly-revenue').textContent = `$${monthly(dailyRevenue).toFixed(2)}`;
      document.getElementById('monthly-elec').textContent = `$${monthly(dailyElecCost).toFixed(2)}`;
      document.getElementById('monthly-profit-detail').textContent = `$${monthlyProfit.toFixed(2)}`;
      
      document.getElementById('yearly-revenue').textContent = `$${yearly(dailyRevenue).toFixed(2)}`;
      document.getElementById('yearly-elec').textContent = `$${yearly(dailyElecCost).toFixed(2)}`;
      document.getElementById('yearly-profit').textContent = `$${yearly(dailyProfit).toFixed(2)}`;
      
      document.getElementById('results-panel').scrollIntoView({ behavior: 'smooth' });
    }
    
    // ============================================
    // BROWSE TABLE
    // ============================================
    function toggleBrowse() {
      const btn = document.getElementById('browse-toggle');
      const container = document.getElementById('browse-table-container');
      btn.classList.toggle('open');
      container.classList.toggle('open');
    }
    
    function renderBrowseTable() {
      const tbody = document.getElementById('browse-tbody');
      tbody.innerHTML = ALL_MINERS.map(m => `
        <tr onclick="selectMinerFromTable('${m.id}')" style="cursor: pointer;">
          <td class="${m.loki ? 'loki' : ''}">${m.name}</td>
          <td>${m.algorithm}</td>
          <td>${m.hashrate} ${m.unit}</td>
          <td>${m.power}W</td>
          <td class="${m.voltage === '120V' ? 'v120' : 'v240'}">${m.voltage}</td>
          <td>$${getDailyCost(m.power).toFixed(2)}</td>
        </tr>
      `).join('');
    }
    
    function selectMinerFromTable(id) {
      const miner = ALL_MINERS.find(m => m.id === id);
      if (!miner) return;
      
      // Set voltage filter
      document.getElementById('voltage-filter').value = miner.voltage;
      
      // Set algorithm filter
      document.getElementById('algorithm-filter').value = miner.algorithm;
      
      // Update miner dropdown with new filters
      updateMinerDropdown();
      
      // Select the miner
      document.getElementById('miner-select').value = id;
      selectMiner();
      
      // Scroll to miner section
      document.getElementById('miner-info').scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    
    function sortTable(colIndex) {
      const tbody = document.getElementById('browse-tbody');
      const rows = Array.from(tbody.querySelectorAll('tr'));
      
      rows.sort((a, b) => {
        let aVal = a.cells[colIndex].textContent;
        let bVal = b.cells[colIndex].textContent;
        
        const aNum = parseFloat(aVal.replace(/[^0-9.-]/g, ''));
        const bNum = parseFloat(bVal.replace(/[^0-9.-]/g, ''));
        
        if (!isNaN(aNum) && !isNaN(bNum)) {
          return (aNum - bNum) * sortDirection;
        }
        return aVal.localeCompare(bVal) * sortDirection;
      });
      
      sortDirection *= -1;
      rows.forEach(row => tbody.appendChild(row));
    }
    
    // ============================================
    // EVENT LISTENERS
    // ============================================
    document.getElementById('voltage-filter').addEventListener('change', updateMinerDropdown);
    document.getElementById('algorithm-filter').addEventListener('change', function() {
      const miningType = document.getElementById('mining-type-filter').value;
      if (miningType === 'ASIC') {
        updateMinerDropdown();
      } else {
        updateManualUnit();
      }
    });
    document.getElementById('miner-select').addEventListener('change', selectMiner);
    
    document.getElementById('solar-hours').addEventListener('input', updateTimeline);
    document.getElementById('free-hours').addEventListener('input', updateTimeline);
    document.getElementById('battery-hours').addEventListener('input', updateTimeline);
    document.getElementById('idle-hours').addEventListener('input', updateTimeline);
    document.getElementById('grid-rate').addEventListener('input', updateTimeline);
    
    // ============================================
    // INIT
    // ============================================
    updateMiningType(); // Initialize with ASIC mode
    updateTimeline();
    renderBrowseTable();
    initPrices(); // Fetch live prices on page load
    initPriceInput(); // Enable custom price input for what-if scenarios
  </script>
</body>
</html>
